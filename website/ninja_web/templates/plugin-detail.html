{% extends "base.html" %}

{% load i18n show_stars %}

{% block scripts %}
{{ block.super }}

<script src="/media/js/prototype.js"></script>
{% show_stars_script %}

<script type="text/javascript">
  function rate_plugin(id, pos) {
    //ajax goes here, update item id with stars == pos.
    var post_url = "{$% url rate-plugin id, pos %$}";

    $.ajax(post_url,
      success: function(){
        /* update the rate of this plugin */
      });
  }
</script>
{% endblock %}

{% block bodyclass %}plugin-detail{% endblock %}

{% block content %}
  <div class="content">
    <!-- PLUGINS -->
    <div class="section left big-width" id="plugins">

      <h1>{{ plugin.title }}</h1>
      <h2>{{ plugin.short_description }}</h2>

      <div class="item-tags">
      {% for tag in plugin.get_tags %}
        <a href="{% url tags tag.id %}" alt="{{ tag }}" title="{{ tag }}">{{ tag }}</a>
      {% endfor %}
      </div>

      <div class="right options">
      {% if user.is_authenticated %}
        {% show_stars 3.5 of 5 round to half on change call rate_plugin with 1 %}
        <!-- this A may be obsolete -->
        <a href="#" class="button">Rate it!</a>

      {% else %}
        <a href="{% url auth_login %}" class="button forbidden" title="You have to be registered to vote">Login to vote!</a>
      {% endif %}
      </div>

      <p>{{ p.detail }}</p>

    </div>

    <div class="section right small-width" id="about-plugin-author">
      <h1>Plugin by {{ plugin.author }}</h1>
      <p>{{ plugin.author.brief }}</p>
      <a class="link-web" href="{% url plugin.url %}">More info about the plugin.</a>
      <a class="link-web" href="{% url plugin.author.email %}">Email this ninja.</a>
    </div>


    <div class="section right small-width" id="plugins-sidebar">
      <h1>Rules</h1>
      <h3>As any clean contest, cheaters will be attacked by criminal ninjas working for us, so show respect:</h3>

      <ol id="rules-list">
        <li>You have to be registered to be able to vote.</li>
        <li>What you are <b>able</b> to do:
        <li>You can <b>Vote/Rate</b> all the plugins you want.</li>
        <li>You can't Vote/Rate the same plugin twice.</li>
        <li>Ninja IDE has the power to audit suspected votes/rates, being able to dismiss any proven cheat.</li>
      </ol>
    </div>

  </div><!-- /content -->
{% endblock %}
